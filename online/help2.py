#coding=utf-8
import numpy as np
import json
from datetime import timedelta,date
import datetime
from mysql.MysqlHelper import *
#返回斜率
def fitSLR(x,y):
    n=len(x)    #获取x的长度，x是list
    if n<=1:
        return 0
    dinominator = 0.0#初始化分母
    numerator=0.0     #初始化分子
    for i in range(0,n):    #求b1

        numerator += (x[i]-np.mean(x))*(y[i]-np.mean(y))

        dinominator += (x[i]-np.mean(x))**2 #**表示平方


    b1 = numerator/float(dinominator)   #得出b1,斜率
    b0 = np.mean(y)/float(np.mean(x))   #得出b0
    #y = b0+x*b1
    return b1
    #return b0,b1
def realPoint(min,max,val):
    #200个点代表max - min
    return -100+(val -min)/(max - min)*200

#获取第几波 第几只股票 第几天的price和money处理好的斜率
def stock_info(wn,sn,dayn):
    #now = datetime.datetime.now() - timedelta(days=4)
    now = datetime.datetime.now()
    this_week_start = now - timedelta(days=now.weekday())
    day1 = this_week_start.strftime('%Y-%m-%d')
    day2 = (this_week_start + timedelta(days=1)).strftime('%Y-%m-%d')
    day3 = (this_week_start + timedelta(days=2)).strftime('%Y-%m-%d')
    day4 = (this_week_start + timedelta(days=3)).strftime('%Y-%m-%d')
    day5 = (this_week_start + timedelta(days=4)).strftime('%Y-%m-%d')
    weekday_arr = [0, day1, day2, day3, day4, day5]
    db = MysqlHelper()
    all_stock_sql = "select * from tan_stock where is_big=2"
    all_stock = db.get_all(all_stock_sql)
    stockn = int((wn - 1) * 10 + sn)
    sid = all_stock[stockn - 1][1]
    sname = all_stock[stockn - 1][2]
    sql = "select * from tan_stock_record where sid='%s' and date='%s'" % (sid, weekday_arr[dayn])

    stock_info = db.get_all(sql)
    if len(stock_info)==0:
        #return price, money, x, sname, sid, pzdf_max, pzdf_min, money_max, money_min, next_pzdf_min, next_pzdf_max, next_price
        return [], [], [], sname, sid, 0, 0, 0, 0, 0, 0, [],(0,0),(0,0)
    price = []
    money = []
    x = []
    xi = 0
    price_min = 9999999
    price_max = -9999999
    money_min = 9999999
    money_max = -99999999
    price_all_half_slope = (0,0)
    money_all_half_slope = (0,0)
    # 只为了得出最大值和最小值
    pre = 0
    for one_stock in stock_info:
        # 占多少格
        pre = one_stock[7]
        temp_price = one_stock[3]
        temp_money = (one_stock[9] - one_stock[10] + one_stock[11] - one_stock[12])/10000
        if temp_price > price_max:
            price_max = temp_price
        if temp_price < price_min:
            price_min = temp_price
        if temp_money > money_max:
            money_max = temp_money
        if temp_money < money_min:
            money_min = temp_money


    pzdf_min = round((price_min-pre)/pre*100,1)
    pzdf_max = round((price_max-pre)/pre*100,1)



    #计算斜率
    for one_stock in stock_info:
        xi += 1
        x.append(xi)
        # 占多少格
        temp_price = one_stock[3]
        temp_money = (one_stock[9] - one_stock[10] + one_stock[11] - one_stock[12]) / 10000
        price.append(realPoint(price_min, price_max, temp_price))
        money.append(realPoint(money_min, money_max, temp_money))

    #获取第二天股价的最高涨幅和最低涨幅
    if dayn == 5:
        next_pzdf_min, next_pzdf_max = 0,0

        next_price = []
    else:
        sql = "select * from tan_stock_record where sid='%s' and date='%s'" % (sid, weekday_arr[dayn+1])
        stock_info = db.get_all(sql)

        price_max = -9999999
        price_min = 9999999
        # 只为了得出最大值和最小值
        pre = 0
        for one_stock in stock_info:
            # 占多少格
            pre = one_stock[7]
            temp_price = one_stock[3]
            if temp_price > price_max:
                price_max = temp_price
            if temp_price < price_min:
                price_min = temp_price
        #100等分
        next_price = []
        for one_stock in stock_info:
            # 占多少格
            next_price.append(realPoint(price_min,price_max,one_stock[3]))


        next_pzdf_min = round((price_min - pre) / pre * 100, 1)
        next_pzdf_max = round((price_max - pre) / pre * 100, 1)
        #price,money是计算好的斜率
        money_all_half_slope = all_half_slope(x,money)
        price_all_half_slope = all_half_slope(x,price)

    return price,money,x,sname,sid,pzdf_max,pzdf_min,money_max,money_min,next_pzdf_min,next_pzdf_max,next_price,money_all_half_slope,price_all_half_slope

#全部点和后半段的斜率
def all_half_slope(x,y):
    n = len(x)  # 获取x的长度，x是list
    if n <= 1:
        return 0
    dinominator = 0.0  # 初始化分母
    numerator = 0.0  # 初始化分子

    half_x = []
    half_y = []
    for i in range(0, n):  # 求b1
        numerator += (x[i] - np.mean(x)) * (y[i] - np.mean(y))
        dinominator += (x[i] - np.mean(x)) ** 2  # **表示平方
        if i>=n/2:
            half_x.append(x[i])
            half_y.append(y[i])
    all_slope = numerator / float(dinominator)  # 得出b1,斜率

    half_dinominator = 0.0  # 初始化分母
    half_numerator = 0.0  # 初始化分子
    half_n = len( half_x)
    # print(half_n)
    # print(half_x)
    # print(half_y)
    for j in range(0, half_n):  # 求b1
        half_numerator += (half_x[j] - np.mean(half_x)) * (half_y[j] - np.mean(half_y))
        half_dinominator += (half_x[j] - np.mean(half_x)) ** 2  # **表示平方

    half_slope =  half_numerator / float(half_dinominator)  # 得出b1,斜率
    return round(all_slope,2),round(half_slope,2)


def stock_today(sn=1):
    offset = sn-1
    today  = datetime.datetime.now().strftime('%Y-%m-%d')
    #today = '2018-09-17'
    sql = "SELECT * from tan_stock_content WHERE date='%s' order by id desc LIMIT %s,1"%(today,offset)
    # print(sql)
    db = MysqlHelper()
    stock_info = db.get_one(sql)
    price_content = stock_info[2]
    money_content = stock_info[3]
    sid = stock_info[1]

    key = 'hs_%s'%(sid)
    price_dict = decode_stock_json(price_content)
    money_dict = decode_stock_json(money_content)

    price_data = price_dict[key]['data'].split(';')
    is_stop = price_dict[key]['stop']
    #停牌
    if is_stop:
        #price, money, x, sname, sid, pzdf_max, pzdf_min,money_max, money_min, money_all_half_slope, price_all_half_slope
        sql = "select * from tan_stock where sid='%s'" % (sid)

        stock = db.get_one(sql)
        sname = stock[2]
        return [],[],[],'%s停牌'%(sname),sid,0,0,0,0,(0,0),(0,0)
    pre = float(price_dict[key]['pre'])
    money_data = money_dict[key]['data'].split(';')
    #price所有价格集合，所有money集合
    price = []
    money = []
    x = []
    xi = 0

    price_min = 9999999
    price_max = -9999999
    money_min = 9999999
    money_max = -99999999
    price_all_half_slope = (0, 0)
    money_all_half_slope = (0, 0)
    # 只为了得出最大值和最小值

    for i in range(len(price_data)):
        xi += 1
        x.append(xi)
        price_temp_arr = price_data[i].split(',')
        temp_price = float(price_temp_arr[1])
        money_temp_arr = money_data[i].split(',')
        temp_money = ( float(money_temp_arr[1]) - float(money_temp_arr[2]) + float(money_temp_arr[3]) - float(money_temp_arr[4]) ) /1000

        if temp_price > price_max:
            price_max = temp_price
        if temp_price < price_min:
            price_min = temp_price
        if temp_money > money_max:
            money_max = temp_money
        if temp_money < money_min:
            money_min = temp_money

    pzdf_min = round((price_min - pre) / pre * 100, 1)
    pzdf_max = round((price_max - pre) / pre * 100, 1)
    for i in range(len(price_data)):
        #第i个点
        #股价
        price_temp_arr = price_data[i].split(',')
        temp_price = float(price_temp_arr[1])

        #大单
        money_temp_arr = money_data[i].split(',')
        temp_money = ( float(money_temp_arr[1]) - float(money_temp_arr[2]) + float(money_temp_arr[3]) - float(money_temp_arr[4]) ) /1000

        price.append(realPoint(price_min, price_max, temp_price))
        money.append(realPoint(money_min, money_max, temp_money))



    sql = "select * from tan_stock where sid='%s'"%(sid)

    stock = db.get_one(sql)
    sname = stock[2]

    money_all_half_slope = all_half_slope(x, money)
    price_all_half_slope = all_half_slope(x, price)

    return price, money, x, sname, sid, pzdf_max, pzdf_min,money_max, money_min, money_all_half_slope, price_all_half_slope

#解
def decode_stock_json(content):

    c1 = content.split('last(')[1].strip(')')
    c2 = json.loads(c1)
    return c2

#给定price_content和money_content，判断是否需要观察
def should_watch(sid,price_content,money_content):
    key = 'hs_%s' % (sid)
    price_dict = decode_stock_json(price_content)
    money_dict = decode_stock_json(money_content)

    price_data = price_dict[key]['data'].split(';')
    #昨日封盘价
    pre = float(price_dict[key]['pre'])
    money_data = money_dict[key]['data'].split(';')
    # price所有价格集合，所有money集合
    price = []
    money = []
    x = []
    xi = 0
    price_min = 9999999
    price_max = -9999999
    money_min = 9999999
    money_max = -99999999
    price_all_half_slope = (0, 0)
    money_all_half_slope = (0, 0)
    # 只为了得出最大值和最小值

    for i in range(len(price_data)):
        xi += 1
        x.append(xi)
        price_temp_arr = price_data[i].split(',')
        temp_price = float(price_temp_arr[1])
        money_temp_arr = money_data[i].split(',')
        temp_money = (float(money_temp_arr[1]) - float(money_temp_arr[2]) + float(money_temp_arr[3]) - float(
            money_temp_arr[4])) / 1000

        if temp_price > price_max:
            price_max = temp_price
        if temp_price < price_min:
            price_min = temp_price
        if temp_money > money_max:
            money_max = temp_money
        if temp_money < money_min:
            money_min = temp_money

    pzdf_min = round((price_min - pre) / pre * 100, 1)
    pzdf_max = round((price_max - pre) / pre * 100, 1)
    #取price_data和money_data的最小长度，
    for i in range(len(price_data)):
        # 第i个点
        # 股价
        price_temp_arr = price_data[i].split(',')
        temp_price = float(price_temp_arr[1])

        # 大单
        money_temp_arr = money_data[i].split(',')
        temp_money = (float(money_temp_arr[1]) - float(money_temp_arr[2]) + float(money_temp_arr[3]) - float(
            money_temp_arr[4])) / 1000

        price.append(realPoint(price_min, price_max, temp_price))
        money.append(realPoint(money_min, money_max, temp_money))

    money_all_half_slope = all_half_slope(x, money)
    price_all_half_slope = all_half_slope(x, price)
    return money_all_half_slope,price_all_half_slope

if __name__ == '__main__':
    sid = '000977'
    price_content = 'quotebridge_v6_time_hs_000977_last({"hs_000977":{"name":"u6d6au6f6eu4fe1u606f","open":1,"stop":0,"rt":"0930-1130,1300-1500","tradeTime":["0930-1130","1300-1500"],"pre":"23.18","date":"20180918","data":"0930,23.16,1800458,23.160,77740;0931,23.33,5281770,23.185,227732;0932,23.40,8441251,23.281,361318;0933,23.35,5896998,23.309,252200;0934,23.48,7715863,23.320,330437;0935,23.44,10318086,23.351,440208;0936,23.45,7787896,23.364,332400;0937,23.38,7099755,23.370,303227;0938,23.41,3945961,23.372,168664;0939,23.50,9245520,23.382,394354;0940,23.45,9358440,23.397,398100;0941,23.43,5034998,23.398,215011;0942,23.45,6044245,23.400,258032;0943,23.50,5307452,23.406,225800;0944,23.43,7966214,23.411,339522;0945,23.36,4172588,23.410,178381;0946,23.39,3080277,23.409,131751;0947,23.33,5600233,23.408,239449;0948,23.29,6808809,23.402,292300;0949,23.25,5307180,23.397,227900;0950,23.31,3376913,23.394,145012;0951,23.30,4446240,23.391,190788;0952,23.32,3634762,23.387,156300;0953,23.37,2440250,23.386,104563;0954,23.30,2325010,23.386,99549;0955,23.33,1809810,23.385,77600;0956,23.43,2547440,23.385,108923;0957,23.40,3777880,23.386,161428;0958,23.43,4146740,23.387,176900;0959,23.41,2347490,23.388,100200;1000,23.52,10087740,23.393,429778;1001,23.51,3291180,23.395,140000;1002,23.50,2970700,23.397,126400;1003,23.50,2114240,23.398,90000;1004,23.48,3061820,23.400,130300;1005,23.64,11508220,23.409,488450;1006,23.60,6839550,23.416,289800;1007,23.61,7278720,23.423,308100;1008,23.55,8038760,23.430,340600;1009,23.57,3246770,23.432,137900;1010,23.59,3194780,23.434,135500;1011,23.56,2218920,23.435,94100;1012,23.60,5553480,23.439,235300;1013,23.59,3607120,23.442,152900;1014,23.61,3427830,23.444,145300;1015,23.64,5796340,23.449,245200;1016,23.65,10427080,23.456,441127;1017,23.61,2964130,23.458,125509;1018,23.57,2553180,23.460,108191;1019,23.55,3642170,23.461,154700;1020,23.56,1625150,23.461,69000;1021,23.55,2351700,23.462,99900;1022,23.57,3511620,23.463,149200;1023,23.50,2660710,23.464,113100;1024,23.50,3088660,23.464,131400;1025,23.50,3152790,23.465,134200;1026,23.54,2664330,23.465,113300;1027,23.50,1442770,23.465,61300;1028,23.55,1334950,23.466,56700;1029,23.51,1267560,23.466,53900;1030,23.47,2556290,23.466,108800;1031,23.49,1890140,23.466,80500;1032,23.53,1310160,23.467,55736;1033,23.55,1571070,23.467,66700;1034,23.54,1616830,23.468,68600;1035,23.53,880130,23.468,37400;1036,23.50,3061220,23.468,130200;1037,23.50,729710,23.468,31064;1038,23.49,1151170,23.468,49000;1039,23.46,5002590,23.468,213258;1040,23.45,1789590,23.468,76300;1041,23.50,3312360,23.468,141100;1042,23.50,1074150,23.468,45700;1043,23.52,905120,23.468,38500;1044,23.48,1040730,23.469,44300;1045,23.45,1006800,23.469,42900;1046,23.38,4477390,23.468,191300;1047,23.38,2084000,23.467,89200;1048,23.40,2377440,23.466,101700;1049,23.41,594570,23.466,25400;1050,23.36,3294970,23.465,140900;1051,23.29,6001730,23.463,257400;1052,23.24,9223780,23.457,396900;1053,23.26,7699570,23.451,331581;1054,23.30,2419750,23.450,103900;1055,23.32,1646570,23.450,70600;1056,23.30,3695150,23.448,158400;1057,23.30,1921000,23.447,82500;1058,23.31,1218620,23.447,52300;1059,23.38,1749690,23.446,74900;1100,23.36,1935070,23.446,82927;1101,23.37,939170,23.446,40200;1102,23.40,1435970,23.445,61344;1103,23.41,1126100,23.445,48100;1104,23.33,1575210,23.445,67400;1105,23.33,686180,23.445,29400;1106,23.40,696360,23.445,29800;1107,23.38,1279160,23.444,54700;1108,23.37,1048990,23.444,44900;1109,23.34,1444740,23.444,61900;1110,23.31,1559410,23.443,66900;1111,23.37,1111450,23.443,47600;1112,23.35,1029780,23.443,44100;1113,23.36,1520860,23.442,65100;1114,23.31,2536930,23.442,108800;1115,23.29,1251020,23.441,53700;1116,23.28,3206290,23.440,137700;1117,23.23,3685730,23.438,158600;1118,23.22,5927300,23.434,255400;1119,23.24,3394570,23.432,146300;1120,23.27,1130010,23.432,48600;1121,23.21,1861730,23.431,80200;1122,23.25,1286110,23.430,55400;1123,23.27,781760,23.430,33600;1124,23.22,1171390,23.429,50400;1125,23.22,1289790,23.429,55500;1126,23.28,386400,23.428,16600;1127,23.29,1161470,23.428,49900;1128,23.27,558500,23.428,24000;1129,23.24,1111460,23.427,47800;1130,23.21,2049850,23.426,88309;1300,23.21,1663670,23.425,71700;1301,23.21,1663670,23.425,71700;1302,23.27,829550,23.425,35700;1303,23.28,469450,23.425,20171;1304,23.34,1629150,23.424,69900;1305,23.33,1051800,23.424,45100;1306,23.35,1365440,23.424,58500;1307,23.37,1096250,23.424,46900;1308,23.40,1534800,23.424,65600;1309,23.39,729830,23.424,31200;1310,23.38,762390,23.423,32600;1311,23.38,467550,23.423,20000;1312,23.39,888640,23.423,38000;1313,23.37,872020,23.423,37300;1314,23.41,2263160,23.423,96700;1315,23.43,1072430,23.423,45800;1316,23.46,1959530,23.423,83600;1317,23.43,606940,23.423,25900;1318,23.42,630120,23.423,26900;1319,23.50,2867670,23.423,122300;1320,23.47,2179610,23.424,92800;1321,23.52,6024420,23.425,256009;1322,23.51,1088400,23.425,46291;1323,23.46,1193440,23.426,50800;1324,23.46,818730,23.426,34900;1325,23.42,1143970,23.426,48800;1326,23.41,1736650,23.426,74200;1327,23.41,674220,23.426,28800;1328,23.41,580390,23.426,24800;1329,23.40,853920,23.425,36500;1330,23.39,1253450,23.425,53600;1331,23.38,439590,23.425,18800;1332,23.37,278200,23.425,11900;1333,23.37,432420,23.425,18500;1334,23.45,1335170,23.425,57000;1335,23.48,1955480,23.425,83300;1336,23.47,1028230,23.426,43800;1337,23.51,5278640,23.427,224509;1338,23.40,2421240,23.427,103091;1339,23.40,1530660,23.427,65400;1340,23.44,866990,23.427,37000;1341,23.45,1404260,23.427,59905;1342,23.41,1977690,23.427,84395;1343,23.40,1499700,23.427,64005;1344,23.40,2195870,23.427,93900;1345,23.38,1078000,23.427,46100;1346,23.39,841190,23.426,36000;1347,23.33,2190690,23.426,93800;1348,23.33,927990,23.426,39800;1349,23.30,2158780,23.425,92600;1350,23.33,5134980,23.423,221000;1351,23.30,670920,23.423,28800;1352,23.36,3153840,23.423,135100;1353,23.38,1711610,23.423,73200;1354,23.42,1636230,23.423,69900;1355,23.47,4691540,23.423,199970;1356,23.46,3660450,23.423,156200;1357,23.49,4214470,23.424,179400;1358,23.50,3293460,23.424,140100;1359,23.47,1960150,23.424,83400;1400,23.45,2665070,23.425,113600","dotsCount":242,"dates":["20180918"]}})'
    money_content = 'quotebridge_v2_moneyflow_hs_000977_last({"hs_000977":{"name":"u6d6au6f6eu4fe1u606f","open":1,"rt":"0930-1130,1300-1500","date":"20180918","tradeTime":["0930-1130","1300-1500"],"data":"0930,-0.00,-0.00,907872.00,-0.00,69040.00,145885.00,335820.00,295521.60;0931,-0.00,-0.00,1237284.00,301476.00,1781731.00,1068172.00,1829974.80,663267.60;0932,-0.00,-0.00,3304074.10,301476.00,3187983.00,2189798.00,3476276.70,2988992.60;0933,-0.00,-0.00,3304074.10,680072.00,4312624.00,3300222.00,5251756.70,4571729.60;0934,-0.00,-0.00,3637264.10,680072.00,5983041.00,3958724.00,9193129.90,5695845.60;0935,2439832.00,-0.00,4576607.10,1560958.00,7497373.00,4621919.00,11267126.00,7441387.80;0936,3611292.00,-0.00,6638517.10,1877128.00,8619630.00,5186478.00,12954444.00,8352488.80;0937,3611292.00,1603087.40,8056217.90,2192879.60,9657934.00,5805704.00,13845576.00,9569386.80;0938,3611292.00,1603087.40,8414230.90,2192879.60,10448837.00,6172991.00,14774672.00,11070049.10;0939,3611292.00,1603087.40,10284807.90,3040131.50,11420021.00,6984915.00,18422893.00,12107662.10;0940,3611292.00,1603087.40,12873903.90,3509331.50,12833110.00,8206927.00,19577538.00,14529075.00;0941,3611292.00,1603087.40,13310073.90,4736785.90,13232555.00,8844029.00,20428003.00,16137741.00;0942,5619707.50,1603087.40,13628586.00,5429089.80,13911343.00,9698706.00,21116705.00,16956983.00;0943,5619707.50,1603087.40,14766319.00,5429089.80,14962102.00,10429505.00,22663927.00,17793207.00;0944,5619707.50,1603087.40,17474776.00,7419576.70,15950137.00,10887163.00,23455074.00,18823672.00;0945,5619707.50,1603087.40,17804716.00,8772236.30,16675466.00,11348370.00,24237178.00,19333376.00;0946,5619707.50,1603087.40,18790949.00,8772236.30,17428970.00,11818956.00,24466903.00,19989947.00;0947,5619707.50,2627294.50,18790949.00,9567217.60,17931884.00,12191032.00,26053503.00,21269760.00;0948,5619707.50,2627294.50,19993361.00,11846440.60,18460764.00,12887538.00,27099783.00,22325348.00;0949,5619707.50,2627294.50,20825171.00,13242991.60,19245563.00,13383559.00,28327632.00,22942078.00;0950,5619707.50,2627294.50,21407671.00,13941490.00,20254523.00,13921065.00,28874750.00,22942078.00;0951,5619707.50,2627294.50,21881026.00,16592608.00,20541597.00,14253831.00,29234054.00,23282372.00;0952,5619707.50,2627294.50,21881026.00,17847735.00,21421253.00,14593498.00,29677931.00,23991809.00;0953,5619707.50,2627294.50,22183491.00,17847735.00,22322478.00,14924822.00,30074809.00,24488458.00;0954,5619707.50,2627294.50,22183491.00,17847735.00,22782821.00,15401333.00,30697511.00,24810836.00;0955,5619707.50,2627294.50,22997359.00,18314177.00,22978824.00,15555210.00,30916813.00,25230596.00;0956,5619707.50,2627294.50,23420838.00,18314177.00,23568489.00,15786791.00,31868543.00,25555782.00;0957,5619707.50,2627294.50,23420838.00,19226011.00,24057930.00,16251678.00,33206997.00,26138442.00;0958,5619707.50,2627294.50,24428968.00,19226011.00,24407220.00,16532806.00,35148291.00,26714689.00;0959,5619707.50,2627294.50,24897768.00,19647507.00,24826682.00,16771720.00,35551398.00,27119768.00;1000,9888615.70,4958321.80,25956017.00,20932837.00,25049639.00,17130542.00,35858505.00,27379789.00;1001,9888615.70,4958321.80,26569846.00,20932837.00,25519659.00,17765045.00,36996509.00,27791111.00;1002,11076462.70,4958321.80,26569846.00,21284694.00,25834486.00,18030539.00,37280846.00,28272877.00;1003,11076462.70,4958321.80,26569846.00,21596978.00,26433663.00,18286594.00,37767198.00,28658025.00;1004,12252013.70,4958321.80,27004722.00,21596978.00,26788407.00,18556691.00,38476530.00,28944459.00;1005,13952162.00,4958321.80,29535498.00,21596978.00,27878097.00,19157556.00,43204840.00,29793339.00;1006,13952162.00,4958321.80,30596668.00,22737569.00,29131170.00,19480837.00,44706114.00,31377135.00;1007,13952162.00,4958321.80,30946685.00,23065610.00,30222410.00,20201518.00,47869733.00,33004625.00;1008,15625621.00,6139679.80,31329329.00,23492231.00,30713484.00,20682968.00,49181798.00,35092348.00;1009,15625621.00,6139679.80,31329329.00,23844757.00,31325695.00,21085504.00,50150084.00,35961139.00;1010,15625621.00,6139679.80,32116982.00,23844757.00,31865560.00,21531128.00,51197004.00,36371204.00;1011,15625621.00,6139679.80,32525262.00,23844757.00,32155574.00,22254842.00,51576640.00,36795553.00;1012,17073984.00,6139679.80,33597825.00,24640622.00,32393871.00,22722051.00,52105260.00,37798115.00;1013,17073984.00,6139679.80,34239745.00,24640622.00,32698213.00,23413156.00,53164561.00,38718005.00;1014,17073984.00,6139679.80,35674272.00,24975458.00,33179541.00,24012269.00,53431281.00,39019879.00;1015,17073984.00,6139679.80,37600622.00,24975458.00,34453980.00,24588811.00,55213907.00,39322471.00;1016,18966191.00,6139679.80,38965337.00,27397108.00,35621555.00,25198599.00,57284786.00,40144695.00;1017,18966191.00,6139679.80,38965337.00,27397108.00,36528763.00,25779574.00,58378552.00,40408803.00;1018,18966191.00,6139679.80,38965337.00,27826416.00,37321875.00,26322225.00,58765616.00,41045795.00;1019,18966191.00,6139679.80,38965337.00,28766879.00,38146333.00,27007430.00,59552469.00,41340228.00;1020,18966191.00,6139679.80,38965337.00,28766879.00,38768215.00,27426613.00,59952845.00,41526291.00;1021,18966191.00,6139679.80,38965337.00,29472813.00,39547654.00,27730199.00,60454628.00,41825205.00;1022,18966191.00,6139679.80,38965337.00,31118797.00,40139005.00,27880961.00,60982592.00,42178093.00;1023,18966191.00,6139679.80,38965337.00,32018996.00,40781827.00,28182339.00,61144900.00,42724018.00;1024,18966191.00,6139679.80,39381450.00,32018996.00,41752870.00,28506519.00,61941872.00,43398371.00;1025,18966191.00,6139679.80,39381450.00,32018996.00,42744679.00,28861194.00,62874803.00,44285843.00;1026,18966191.00,6139679.80,39381450.00,32724066.00,43436384.00,29169286.00,62980688.00,45113531.00;1027,18966191.00,6139679.80,39381450.00,32724066.00,43730664.00,29418771.00,63611677.00,45113531.00;1028,18966191.00,6139679.80,39381450.00,33025030.00,44032003.00,29708340.00,64127373.00,45325391.00;1029,18966191.00,6139679.80,39381450.00,33343837.00,44176286.00,29953865.00,64426090.00,45550375.00;1030,18966191.00,6139679.80,39381450.00,34142413.00,44397284.00,30301728.00,64795000.00,46368060.00;1031,18966191.00,6139679.80,39381450.00,34567147.00,44554604.00,30566997.00,65593726.00,46663782.00;1032,18966191.00,6139679.80,39710450.00,34567147.00,44785877.00,30743227.00,66038032.00,46790785.00;1033,18966191.00,6139679.80,40344534.00,34567147.00,44943690.00,30870385.00,66341780.00,47155524.00;1034,18966191.00,6139679.80,40344534.00,34567147.00,45186403.00,31294594.00,66573156.00,47859928.00;1035,18966191.00,6139679.80,40344534.00,34567147.00,45245254.00,31407511.00,66909879.00,48198628.00;1036,18966191.00,6139679.80,41109099.00,35530671.00,45336983.00,31717858.00,67424867.00,48647638.00;1037,18966191.00,6139679.80,41109099.00,35530671.00,45399565.00,32056114.00,67631667.00,48819065.00;1038,18966191.00,6139679.80,41109099.00,35530671.00,45517037.00,32349747.00,68009953.00,49138544.00;1039,18966191.00,8015524.70,41109099.00,36915429.00,45825487.00,32541144.00,68357214.00,50024025.00;1040,18966191.00,8015524.70,41740075.00,36915429.00,46097538.00,32759218.00,68863844.00,50178857.00;1041,18966191.00,8015524.70,42129663.00,36915429.00,47006335.00,32902388.00,70239378.00,50521352.00;1042,18966191.00,8015524.70,42129663.00,36915429.00,47326077.00,33135058.00,70356968.00,51087647.00;1043,18966191.00,8015524.70,42129663.00,36915429.00,47415398.00,33320750.00,70629656.00,51216922.00;1044,18966191.00,8015524.70,42129663.00,36915429.00,47497645.00,33466383.00,71081064.00,51785377.00;1045,18966191.00,8015524.70,42129663.00,36915429.00,47589217.00,33745607.00,71196172.00,52325061.00;1046,18966191.00,10317665.70,42129663.00,38013593.00,47692240.00,34035780.00,71491084.00,52774796.00;1047,18966191.00,10317665.70,42129663.00,38013593.00,48023983.00,34423511.00,72152444.00,53454621.00;1048,18966191.00,10317665.70,43041483.00,38013593.00,48292852.00,34694604.00,72741564.00,53753757.00;1049,18966191.00,10317665.70,43041483.00,38013593.00,48534037.00,34790584.00,72931104.00,53819277.00;1050,18966191.00,10317665.70,43357248.00,39109932.00,48636959.00,35136787.00,73183854.00,54976920.00;1051,18966191.00,13686303.00,43825627.00,39610882.00,48823728.00,35680671.00,73412194.00,55709733.00;1052,18966191.00,17166111.00,44211879.00,41533052.00,49381793.00,36073847.00,74591829.00,57016733.00;1053,18966191.00,20004838.00,44211879.00,42995168.00,50104198.00,36417821.00,75304497.00,58634091.00;1054,18966191.00,20004838.00,44573184.00,43437040.00,50639984.00,36653002.00,75775060.00,59009126.00;1055,18966191.00,20004838.00,45086444.00,43437040.00,50964149.00,36760237.00,76187804.00,59298294.00;1056,18966191.00,21170361.00,45506384.00,43437040.00,51206869.00,36909575.00,77513372.00,59690352.00;1057,18966191.00,21170361.00,45855434.00,43739614.00,51353564.00,37086568.00,77962956.00,60184128.00;1058,18966191.00,21170361.00,45855434.00,43739614.00,51903482.00,37189075.00,78238011.00,60468274.00;1059,18966191.00,21170361.00,46189617.00,43739614.00,52181394.00,37322178.00,78605087.00,61433090.00;1100,18966191.00,22231333.00,46189617.00,43739614.00,52295751.00,37404495.00,78801035.00,61580138.00;1101,18966191.00,22231333.00,46189617.00,43739614.00,52391523.00,37507246.00,79441252.00,61694575.00;1102,18966191.00,22231333.00,46512909.00,43739614.00,52611258.00,38224487.00,79619290.00,61694575.00;1103,18966191.00,22231333.00,46953197.00,43739614.00,52765789.00,38400031.00,79843930.00,61818648.00;1104,18966191.00,22231333.00,47427171.00,43739614.00,52903664.00,39230063.00,79914160.00,61888779.00;1105,18966191.00,22231333.00,47427171.00,43739614.00,53067011.00,39349055.00,80005193.00,62203922.00;1106,18966191.00,22231333.00,47427171.00,43739614.00,53314618.00,39484524.00,80154876.00,62355825.00;1107,18966191.00,22231333.00,47843375.00,44097481.00,53515812.00,39587360.00,80225016.00,62486756.00;1108,18966191.00,22231333.00,47843375.00,44097481.00,53583631.00,39617723.00,80397896.00,63274036.00;1109,18966191.00,22231333.00,47843375.00,44542884.00,53602320.00,39725120.00,80500592.00,63825195.00;1110,18966191.00,22231333.00,48148736.00,44542884.00,53690953.00,39767105.00,80500592.00,65165697.00;1111,18966191.00,22231333.00,48459291.00,44542884.00,53917379.00,39972498.00,80806608.00,65231077.00;1112,18966191.00,22231333.00,48459291.00,45009884.00,53943082.00,40142979.00,80944353.00,65396884.00;1113,18966191.00,22231333.00,48765438.00,45477084.00,54204761.00,40329830.00,81051809.00,65595389.00;1114,18966191.00,23427100.00,49530768.00,45477084.00,54295761.00,40462735.00,81142679.00,65910192.00;1115,18966191.00,23427100.00,49530768.00,45477084.00,54402970.00,40667740.00,81410569.00,66567136.00;1116,18966191.00,23427100.00,50187828.00,45477084.00,54498434.00,41270702.00,81927362.00,67542510.00;1117,18966191.00,23427100.00,50610614.00,47006519.00,54703030.00,41991191.00,82378700.00,68274543.00;1118,18966191.00,24586984.00,51308033.00,49294451.00,54969934.00,42557385.00,82608501.00,68991388.00;1119,18966191.00,24586984.00,51621368.00,50955758.00,55495842.00,42810759.00,82919668.00,69327837.00;1120,18966191.00,24586984.00,51621368.00,51258268.00,55593469.00,43040671.00,83275417.00,69460419.00;1121,18966191.00,24586984.00,51621368.00,51961897.00,55737483.00,43272708.00,83665345.00,69827029.00;1122,18966191.00,24586984.00,51621368.00,51961897.00,56057877.00,43583781.00,83728012.00,70337574.00;1123,18966191.00,24586984.00,52033247.00,51961897.00,56167228.00,43762867.00,83728012.00,70518980.00;1124,18966191.00,24586984.00,52502897.00,51961897.00,56236939.00,43932401.00,84006914.00,70718861.00;1125,18966191.00,24586984.00,52842347.00,51961897.00,56464531.00,44099541.00,84204779.00,71074277.00;1126,18966191.00,24586984.00,52842347.00,51961897.00,56611203.00,44127450.00,84344454.00,71139433.00;1127,18966191.00,24586984.00,53261387.00,51961897.00,56753211.00,44411349.00,84344454.00,71437317.00;1128,18966191.00,24586984.00,53261387.00,51961897.00,56890549.00,44495126.00,84639983.00,71497819.00;1129,18966191.00,24586984.00,53261387.00,51961897.00,57086014.00,45104189.00,84725943.00,71716473.00;1130,18966191.00,24586984.00,53261387.00,52544349.00,57139413.00,45334009.00,85099654.00,72536240.00;1300,18966191.00,24586984.00,53261387.00,52544349.00,57573164.00,45651813.00,85378159.00,73151288.00;1301,18966191.00,24586984.00,53261387.00,52544349.00,57573164.00,45651813.00,85378159.00,73151288.00;1302,18966191.00,24586984.00,53261387.00,52544349.00,57763596.00,45712174.00,85889458.00,73216360.00;1303,18966191.00,24586984.00,53261387.00,52544349.00,57866943.00,45806596.00,86121550.00,73276888.00;1304,18966191.00,24586984.00,53261387.00,52544349.00,57922866.00,46130354.00,86741332.00,73701231.00;1305,18966191.00,24586984.00,53261387.00,52544349.00,57946179.00,46391483.00,87441076.00,73974192.00;1306,18966191.00,24586984.00,53261387.00,52544349.00,57978839.00,46636438.00,88176289.00,74294107.00;1307,18966191.00,24586984.00,53261387.00,52544349.00,58051278.00,46827953.00,88779574.00,74539447.00;1308,18966191.00,24586984.00,53759804.00,52544349.00,58149546.00,46989292.00,89249926.00,74686776.00;1309,18966191.00,24586984.00,53759804.00,52544349.00,58224403.00,47152967.00,89738913.00,74820099.00;1310,18966191.00,24586984.00,54110651.00,52544349.00,58229079.00,47513066.00,89738913.00,74890269.00;1311,18966191.00,24586984.00,54110651.00,52544349.00,58432485.00,47650959.00,89738913.00,75016517.00;1312,18966191.00,24586984.00,54452142.00,52544349.00,58472243.00,47898800.00,89738913.00,75276062.00;1313,18966191.00,24586984.00,54917404.00,52544349.00,58540055.00,48181648.00,89809053.00,75276062.00;1314,18966191.00,24586984.00,54917404.00,52544349.00,58879478.00,48345487.00,91512719.00,75336954.00;1315,18966191.00,24586984.00,54917404.00,52544349.00,59212004.00,48471907.00,91910859.00,75549957.00;1316,20070321.00,24586984.00,54917404.00,52544349.00,59324469.00,48799813.00,92067840.00,75549957.00;1317,20070321.00,24586984.00,54917404.00,52544349.00,59575274.00,48909951.00,92389198.00,75732642.00;1318,20070321.00,24586984.00,54917404.00,52544349.00,59692424.00,49132441.00,92564923.00,75802902.00;1319,20070321.00,24586984.00,54917404.00,52544349.00,60750242.00,49289474.00,94018725.00,76046388.00;1320,20070321.00,24586984.00,55300128.00,52544349.00,61255567.00,49559235.00,94949056.00,76105013.00;1321,22760896.00,24586984.00,55300128.00,53446314.00,61651196.00,49935749.00,95921540.00,76827459.00;1322,22760896.00,24586984.00,55300128.00,53446314.00,61834604.00,50227039.00,96352288.00,77010413.00;1323,22760896.00,24586984.00,55300128.00,53446314.00,61977983.00,50715358.00,96413626.00,77456874.00;1324,22760896.00,24586984.00,55300128.00,53446314.00,62083615.00,51006218.00,96561424.00,77766504.00;1325,22760896.00,24586984.00,55300128.00,53875449.00,62191431.00,51217192.00,96638842.00,78103906.00;1326,22760896.00,24586984.00,55300128.00,54577654.00,62233587.00,51369333.00,96692685.00,78892556.00;1327,22760896.00,24586984.00,55300128.00,54577654.00,62320207.00,51484006.00,97043916.00,78986156.00;1328,22760896.00,24586984.00,55300128.00,54577654.00,62409165.00,51687599.00,97114146.00,79231856.00;1329,22760896.00,24586984.00,55300128.00,54577654.00,62465332.00,51884114.00,97327086.00,79620162.00;1330,22760896.00,24586984.00,55300128.00,54965795.00,62488715.00,52136723.00,97560950.00,79912458.00;1331,22760896.00,24586984.00,55300128.00,54965795.00,62664096.00,52312051.00,97560950.00,80062154.00;1332,22760896.00,24586984.00,55300128.00,54965795.00,62736598.00,52461661.00,97560950.00,80062154.00;1333,22760896.00,24586984.00,55300128.00,54965795.00,62820766.00,52550484.00,97617062.00,80256125.00;1334,22760896.00,24586984.00,55300128.00,54965795.00,63017677.00,52822153.00,98174265.00,80508995.00;1335,22760896.00,24586984.00,56072644.00,54965795.00,63397882.00,53035627.00,98430231.00,80966594.00;1336,22760896.00,24586984.00,56704258.00,54965795.00,63524650.00,53178738.00,98493600.00,80966594.00;1337,25899177.00,24586984.00,56704258.00,55320956.00,63778743.00,53566651.00,98830133.00,81791950.00;1338,25899177.00,24586984.00,56704258.00,55320956.00,64182847.00,53951565.00,99584570.00,82578665.00;1339,25899177.00,24586984.00,56704258.00,55873112.00,64431009.00,54134168.00,99802221.00,83046843.00;1340,25899177.00,24586984.00,56704258.00,55873112.00,64552875.00,54295808.00,100083483.00,83337342.00;1341,25899177.00,24586984.00,56704258.00,55873112.00,64883464.00,54612212.00,100493952.00,83695866.00;1342,25899177.00,24586984.00,56704258.00,56297208.00,65387398.00,54757467.00,101161840.00,83866832.00;1343,25899177.00,24586984.00,57011771.00,56734840.00,65565681.00,55087698.00,101213342.00,84117561.00;1344,25899177.00,24586984.00,57554436.00,56734840.00,65911854.00,55707189.00,101489339.00,84524426.00;1345,25899177.00,24586984.00,57554436.00,56734840.00,66150488.00,55782004.00,101784163.00,85008191.00;1346,25899177.00,24586984.00,57554436.00,57136542.00,66288436.00,55989983.00,101877723.00,85008191.00;1347,25899177.00,25862492.00,57554436.00,57453830.00,66592026.00,56188433.00,101971243.00,85008191.00;1348,25899177.00,25862492.00,57554436.00,57453830.00,66750664.00,56561444.00,102043504.00,85329935.00;1349,25899177.00,25862492.00,57554436.00,58036508.00,66899955.00,57477509.00,102223203.00,85660989.00;1350,25899177.00,30050284.00,57554436.00,58036508.00,67265300.00,57771036.00,102397453.00,85777389.00;1351,25899177.00,30050284.00,57554436.00,58036508.00,67540248.00,58043547.00,102523247.00,85777389.00;1352,25899177.00,30050284.00,58959406.00,58036508.00,68032834.00,58447642.00,103013432.00,86137055.00;1353,25899177.00,30050284.00,58959406.00,58036508.00,68491255.00,58545816.00,103567638.00,86702791.00;1354,25899177.00,30050284.00,58959406.00,58345520.00,68968777.00,58751745.00,103991352.00,86941519.00;1355,29886067.00,30050284.00,58959406.00,58345520.00,69211846.00,58995414.00,104124806.00,87028284.00;1356,29886067.00,30050284.00,60167878.00,59088716.00,69745636.00,59250966.00,104499946.00,87542095.00;1357,29886067.00,30050284.00,62123178.00,59088716.00,70330054.00,59603086.00,105414076.00,87952854.00;1358,29886067.00,30050284.00,62476094.00,59934716.00,70805120.00,60096611.00,105736255.00,88796584.00;1359,29886067.00,30050284.00,63040517.00,59934716.00,71056626.00,60554723.00,106194524.00,88989224.00;1400,29886067.00,30050284.00,63840616.00,60680744.00,71354620.00,60969872.00,106616781.00,88989224.00;1401,29886067.00,30050284.00,64493357.00,60680744.00,72080412.00,61251698.00,108788465.00,89167595.00","dotsCount":242}})'

    print(should_watch(sid,price_content,money_content))
    exit()
